# DI - Dependences Inject
- DI là một trong những nguyên lý cơ bản của OOP, nó giúp giảm sự phụ thuộc giữa các class với nhau, giúp code dễ đọc, dễ hiểu và dễ bảo trì hơn.
- Trong NestJS, DI giúp chúng ta dễ dàng quản lý các dependences giữa các class, module, service, controller, middleware, guard, pipe, interceptor, filter, và resolver.
- DI giúp chúng ta dễ dàng thay đổi các dependences mà không cần phải thay đổi code ở nhiều nơi khác nhau. Tránh việc phải sửa code ở nhiều nơi khác nhau khi có sự thay đổi về dependences.
- DI giúp chúng ta dễ dàng test code, chúng ta có thể mock các dependences mà không cần phải thay đổi code ở nhiều nơi khác nhau.
- DI giúp chúng ta dễ dàng tái sử dụng code, chúng ta có thể sử dụng lại các dependences ở nhiều nơi khác nhau mà không cần phải viết lại code.
- DI giúp chúng ta dễ dàng quản lý các dependences, chúng ta có thể quản lý các dependences một cách dễ dàng và hiệu quả.
- VD không sử dụng DI và sử dụng DI:
>> VD không sử dụng DI:
```java
class AuhtService {
    authen(String username, String password) {
        // code xác thực người dùng
    };
}

class Login {
    private AuthService authService = new AuthService(); // Mỗi lần khai báo Login thì phải khai báo AuthService mới, đây là một sự phụ thuộc giữa các class
    login(String username, String password) {
        authService.authen(username, password);
    }
}

public class Main {
    public static void main(String[] args) {
        Login userApp = new Login(); // Khai báo Login, nó se khai báo AuthService mới
        // Muốn sửa AuthService thì phải sửa ở nhiều nơi khác nhau trong code
        // Ví dụ ta muốn sửa userApp thành databaseApp thì phải sửa ở nhiều nơi khác nhau trong code, làm cho code khó bảo trì và dễ gây lỗi
        userApp.login("admin", "123456");
    }
```

>> VD sử dụng DI:
```java
interface AuhtService {
    authen(String username, String password);
}

class Login {
    private AuthService authService; // Khai báo AuthService ở đây, nó sẽ được inject vào Login thông qua constructor injection, mà không cần phải khai báo AuthService mới (new AuthService())
    Login(AuthService authService) {
        this.authService = authService;
    } // Khai báo AuthService ở đây, nó sẽ được inject vào Login thông qua constructor injection
    login(String username, String password) {
        authService.authen(username, password);
    }
} 

// AuthService sẽ được implement ở class UserAuthService với chức năng xác thực người dùng truy cập vào app
class UserAuthApp implements AuthService {
    authen(String username, String password) {
        // code xác thực người dùng
    };
}

// AuthService sẽ được implement ở class DatabaseAuthService với chức năng xác thực người dùng truy cập vào database
class DatabaseAuthApp implements AuthService {
    authen(String username, String password) {
        // code xác thực người dùng
    };
}

public class Main {
    public static void main(String[] args) {
        AuthService authService = new UserAuthApp(); // Khai báo AuthService ở đây, nó sẽ được inject vào Login thông qua constructor injection, lúc này ta có thể sử dụng UserAuthApp hoặc DatabaseAuthApp
        // authService được implement ở UserAuthApp với chức năng xác thực người dùng truy cập vào app
        Login userApp = new Login(authService); // Khai báo Login, nó se khai báo AuthService mới
        // Muốn sửa AuthService thì chỉ cần sửa ở 1 nơi duy nhất, không cần phải sửa ở nhiều nơi khác nhau trong code
        // Ví dụ ta muốn sửa userApp thành databaseApp thì chỉ cần sửa ở 1 nơi duy nhất, không cần phải sửa ở nhiều nơi khác nhau trong code
        userApp.login("admin", "123456"); // Sử dụng UserAuthApp

        // authService được implement ở DatabaseAuthApp với chức năng xác thực người dùng truy cập vào database
        authService = new DatabaseAuthApp();
        Login databaseApp = new Login(authService); // Khai báo Login, nó se khai báo AuthService mới
        // Muốn sửa AuthService thì chỉ cần sửa ở 1 nơi duy nhất, không cần phải sửa ở nhiều nơi khác nhau trong code
        // Ví dụ ta muốn sửa databaseApp thành userApp thì chỉ cần sửa ở 1 nơi duy nhất, không cần phải sửa ở nhiều nơi khác nhau trong code
        databaseApp.login("admin", "123456") // Sử dụng DatabaseAuthApp
    }
}
```

